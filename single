from pypdf import PdfReader, PdfWriter

# Read the original PDF
reader = PdfReader("fw8bene.pdf")
writer = PdfWriter()

# Get form fields to analyze structure
fields = reader.get_fields()
for field_name, field_info in fields.items():
    print(f"Field: {field_name}, Type: {field_info.get('/FT')}")

# Fill form with data
form_data = {
    "organization_name": "ABC Corporation Ltd",
    "country_incorporation": "India",
    "foreign_tin": "ABCDE1234F"
}

# Update form fields and save
writer.append(reader)
for page in writer.pages:
    writer.update_page_form_field_values(page, form_data)

with open("filled_w8bene.pdf", "wb") as output_file:
    writer.write(output_file)
